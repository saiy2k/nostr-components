import{s as a,b as n,a as o}from"./nostr-service-w4c-zprD.js";var i=Symbol("verified"),l=e=>e instanceof Object;function c(e){if(!l(e)||typeof e.kind!="number"||typeof e.content!="string"||typeof e.created_at!="number"||typeof e.pubkey!="string"||!e.pubkey.match(/^[a-f0-9]{64}$/)||!Array.isArray(e.tags))return!1;for(let t=0;t<e.tags.length;t++){let r=e.tags[t];if(!Array.isArray(r))return!1;for(let s=0;s<r.length;s++)if(typeof r[s]=="object")return!1}return!0}new TextDecoder("utf-8");var y=new TextEncoder,g=class{generateSecretKey(){return a.utils.randomPrivateKey()}getPublicKey(e){return n(a.getPublicKey(e))}finalizeEvent(e,t){const r=e;return r.pubkey=n(a.getPublicKey(t)),r.id=u(r),r.sig=n(a.sign(u(r),t)),r[i]=!0,r}verifyEvent(e){if(typeof e[i]=="boolean")return e[i];const t=u(e);if(t!==e.id)return e[i]=!1,!1;try{const r=a.verify(e.sig,t,e.pubkey);return e[i]=r,r}catch{return e[i]=!1,!1}}};function b(e){if(!c(e))throw new Error("can't serialize event with wrong or missing properties");return JSON.stringify([0,e.pubkey,e.created_at,e.kind,e.tags,e.content])}function u(e){let t=o(y.encode(b(e)));return n(t)}var f=new g,p=f.generateSecretKey,h=f.getPublicKey,E=f.finalizeEvent;f.verifyEvent;export{E as finalizeEvent,p as generateSecretKey,u as getEventHash,h as getPublicKey,b as serializeEvent,c as validateEvent,i as verifiedSymbol};
//# sourceMappingURL=pure-Dx-_USO5.js.map
